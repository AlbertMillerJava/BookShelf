import io.restassured.RestAssured;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

public class BookShelfAppTest {

    private static final String BOOK_1 = "\\{\"title\":\"lalala2\",\"author\":\"polska\",\"pageSum\":1,\"yearOfPublish\":-29,\"publishingHouse\":\"PWN\"\\}";
    private static final String BOOK_2 = "\\{\"title\":\"bylejako\",\"author\":\"jaki≈õtam\",\"pageSum\":1000,\"yearOfPublish\":2020,\"publishingHouse\":\"GITprdukcja\"\\}";

    private static final int APP_PORT =8090;
    private BookShelfApp bookShelfApp;
    @BeforeAll
    public static void beforeAll(){
        RestAssured.port = APP_PORT;
    }
    @BeforeEach
    public void beforeEach() throws Exception{
        bookShelfApp = new BookShelfApp(APP_PORT);
    }

    @AfterEach
    public void afterEach(){
        bookShelfApp.stop();
    }

    @Test
    public void addMethod_correct_shouldReturnStatus200() throws Exception{
        vith().body(BOOK_1).when().post("/book/add").then().statusCode(200).body(startsWith("Book has been successfully added, id ="));
    }
}


